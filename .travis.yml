os: linux
dist: xenial
language: node_js
node_js:
- 14
before_install:
- npm config set //npm.greensock.com/:_authToken=$GSAP_TOKEN
- npm config set @gsap:registry=https://npm.greensock.com
- yarn add gsap@npm:@gsap/shockingly
cache:
  yarn: true
script:
- gatsby build
- rsync -r --delete-after $TRAVIS_BUILD_DIR/public/ $HZH_USER@$HZH_IP:$HZH_DIR/public_$TRAVIS_BRANCH
- node scripts/create_lesson_pdfs_pngs.js --host=$(if [[ $TRAVIS_BRANCH = "develop"
  ]]; then echo "dev.hoezithet.nu"; else echo "hoezithet.nu"; fi) --cwd=$TRAVIS_BUILD_DIR
- rsync -r --delete-after $TRAVIS_BUILD_DIR/public/ $HZH_USER@$HZH_IP:$HZH_DIR/public_$TRAVIS_BRANCH
addons:
  ssh_known_hosts: "$HZH_IP"
branches:
  only:
  - master
  - develop
notifications:
  slack: $HZH_SLACK:XvtMGEvLV8a37LQTUioGFVoa
before_script:
- openssl aes-256-cbc -K $encrypted_db2095f63ba3_key -iv $encrypted_db2095f63ba3_iv
  -in deploy_rsa.enc -out deploy_rsa -d
- eval "$(ssh-agent -s)"
- chmod 600 deploy_rsa
- ssh-add deploy_rsa
- bash scripts/install_quicksand.sh
env:
  global:
  - secure: EV4OJQAseQ5qUwa4OQXTIQp4XXVl8IdzeXkO27gvGwdIY6VVZjS0+biwopDXKBiRyNUJdIYbW/2Tt3AcND+zMgXiPHoXudCNgibDIiKZ001+3acPDp2S71HbugaRM3J+MBjerUhw7c2WRiE3qpTjRvHilcEi3s7I8KcI56w63wCpvYpCufjqG9slAaFC+DpZ28sFlKBRlaiP+3eqS8y7Rgsv+366pYn6jkWfsau2bRaTGa4dLwzEfcDiGSe/7DHRYkxb1iDBuqAzlIdcJveyIIBWidcmbRbQ/neTU63HYgfHcw9WPmXACQyy7i+FyCm9I7Q8DXtV9rydWDfUlTGyWzcxFXFnvcLX8Tbx2N1fPYQWE1PV6B38WT20C3yfIxCxTs3wEx5xeqvgnqGg9AY057CypGf5DqriTkckoJrx8D2NgoLJCsCeu1amyuBvCVfP4MgPxUHSAxUGvBTEYf8ok539IBu/b77kWIRufVaNZTUxE0WV208R/mBCA28+lJbdBn0CKMQLTap9Go275LsYtvCZiQp1g+NuYsEySI5AUGrw6rcHyq4NYFkj1DAdmBbjRHTdCxeoiKse1jbnaYTTcKUZgreOnhi0JO00UPyETHoUrvyTfPYLUH8HOEFkXjxLVpSzxpgnGjeKHOf954Kiqvz1UdHoBdNapyTkK5MQPM8=
  - secure: b9G00OJDVXRn1y+vKHeoTDSWw7/QhQeasKs7ufwTVgRQSdD2so4FIBH5gPYv8TYLqOKoMzpSKfWZjqNL0c5pAI256TW3/VZCCO0q84jCrSGT1cwdMyxJJodmLNiTJg74TXgoKbltJUxT5yddwxxfy6fGB4SvHTgwInTjSkqRoGKknnWR7AE40JwehXvwzwqfMHkXRaTEPMgmpW7P6iIfl5KBxQmmLFSRL2UF+uxG4KoWjfLwaKQbfdl8i1JuZaoEBijG/K7PTknuBLCOV4JR/oAJVxc0Hu3yt/VQj6bs2r6+Bq5IUxUUhgvgj2fY5mJL2W3LatTkPJbVqNIMmeEDp9S38sYcTx5ZuMjNsh04T62zAsFDCGAjOMtB3PHQ7cHGpviS6PTBR4WcbuanBrjLfz88pA33NdSeXCwPA+jGlmwIQ4mkTQJtL/GmA/QNhGlJ548K4PKxuISQlZyKi8WVkxx3earvdZl1zbwO+QJghL8PultESEDQkCXG+Qzj0sCEZkdm9lEpr5ZWNSJE4FIxNW7MSypF9LxTeqNtbQMjmjtLId2J1bMFqt7wzIsxYaLObaXz2+xZeSBJUH2ZUxOprF5A8jSutqmB2Cnolrxc1nZaEjs9SKp+mmvlVCtqHza8d6eBXcHKrT+RLhxvDtyWYNcsjdcWuJVZyYorfwGRpiA=
  - secure: mu/PsWNciyhvIDylrIWc6TvrEW5pOWU8F4ddaRM+ECQBPJ83WDI6u6MKGaMOtmi08XsW9sc5ajbAkkSTySliI4fbOiDy3AaRS9zaYNR4lAfat+zc2rJImelfTL4a8AdnZvoPKb494LtbFs8IhxAA1AXSJxESfSgwiB79EqK4+gWW7UwbRiILznYK1ui+iCDjUJALfpboXBnFzfCQWHTXYEVa2I2Q+JCzbS4tvm3ZV/+Z5hrABun1rRDWSvplGIALQKLgNdn6s2JymhU6HLoOFTIMqYEHe8PuTAFz2t7BZbo0xqs2u/PAZJttbfmstyLqLBwAWKEF5vV8XWo+RPclLaCe4YxDUGVLaIaCgSoKp38y/n+Tqi/e6bOBz6JNeeFLMEc0TuF/hcpOTxC9kpkeY+WDe425W7UCB1hz7gV+3+PE6ktDu0RHMNUcL36YHkTfGBLDsQfR3xwmaAvyGfouEEmd1C49dXF/EfXVT8MzaYk3IP+xvUHD2yK1z/h3ybApE3KSC9XxWizZU0Hguh0FQEi5zsqcXWTw0jR0Qu4vfSq/3fR1J+jQVq0H04Iu0q9tTHxbRqRicrK5Xktu90Muy1HJI3M8ZMcnesj8t3t/URsAewNOv+1nA5tj/c3KfWS+zcgtIPXg4vlJth6YSEaPIsdSOWgCDwh83AQaF4BM9Qk=
  - secure: lu0zsi2i9+ui1utkHFToXLyTSRrZWRjaqFudRVogbiDem3d7/hzHPIxkDEDsx7jXtY19p8nLpzTXAIEYMqz3PgqqO1BnrfY4AkhROXcG7fRqqBmv+mNNBFYUbbbR+DTdHKoi8bhitYYOl7jLjbHqwXVDxKraLRhYafUBWKAhRxvc2ae0+xLhyclTmWZJ7FXh4X8TR60do0XuBcyJLrsq8AxZq7rCJYUiDridEsfdXzuP0F157x3rY7/Xi5JUz+t1ZZ8JshKNk0EhY7s/GGGlh6pSoyDvsxfz7eEnY1XOsB0OR7JCEstXJsbedkQVYowAOo9bSyH1n34Ct28+PfDZ8Xe8VL9IwuCeyeauM6ITbKLTDNB0gi1XHX5TnIyNZ6oMzXfTPST2ITzuxYorRm2wSGu1UJQrVMCy0535ebqEyqdWk1r2BRypWW4cZyYdza68QyRYzx6RToRYVNk1SIs41+pvqq8VIvZ0C0kRhiP7nI90rEDGjvXcArzcqD53IHF2zGpH1n3vV4GGyb3husDJG4ADS91duhlFkCrSYQpLSRkYgUhF8Jh2st4CyOsc356BE1CVZjBdMMgE51qpszVqsuK3wpHrKqmFBkb6U1sa9iikl8eSp2UqQrrLhjTkAI9QMuI3VQaA3Q0HdKHKdRuaVPoWpHet1YxeElFAGlFJCzQ=
  - secure: r4OHByo1o42FleMx87Un08SomPwP9C88m6l6hID60qydq8oIbiIopdTKlNBt2CjdUaFiWiTexqhfk52CPuBQACqwpEHKSRYDKQAVTwNk89Lu5TBnv0i2WCmuZwx2nMhxVMGjKs3np/4aYttj8wTBbqz4utVeByzmpW37XTeifoLkBean1fjPolPVjpIawG+K44ks/K9md/mnR5kA44EYLARo7hmQRMvJsopfba+oYjY6mRJbZFBooma7KwHTve3DK6aa6lmQVvcwS0Y0/4YUGsB8mXhbQbTMUmhj/eGhJxOZkAJXQy9wdBiLR2INGKGCDmuCrhbtueExzAdQAlYc0r5xWtyUKgX4YR7IND/XPUgVOqZeNiJo9enT3nrzKL5x5e/hlFplCPS9gNAmPI92lT2ifGCReO9B5o0x42p+TEc3Fnp89gI1UcZCXeV3rL+fNqErDYNiVhRWW6eFiWO3ma6HtgIUu38r9ISYQZx2QTU1znn7PKLTqfvsquzgtZpaCTAFXaH/q2QjuQ4qhYZSD1RJ45Pa8WckKVHP/zLnWbnQju31M/3qmp/2NEvBUKLBE0hSVbAJsmGfo1Z4YkKTNeZJKhAbpfMvns2Bze7xyudYraKgCR//W3p/M/fgiUklMJXLmQfLXVcY6WmK4j3GpzZDuQfM1nak8BXwHg0WLqc=
  - secure: uFx83v8Rc+fapBrkCKbrK9j869X/yTeEAMZ5LzF8J5ir3EhMQfyfpgsP9Ctmf5OZBxp+8680+I53xo0EBWNvUjhUtt4lAylEubMt4DYIrtSxLsWIua3p+SOC8u5WFvJ3VOvjHQKdh1vSPcMyJtuLxMZwNyaHb1lGl3FI0uz4rrwazc0+FXwtBTOxUyq/Ot0wbSauA/STX3o+fzYvBjY0ITQhziKd2S+As+SUWP3bvOE/sC4NdEsnlGkghmPNQ/zamkkV32m+VegLKQdYXPJg6dnyX9zr+kF252Yaq1GPRBQYWJMVV7DelXma1n/JDxrHhD9LhLHaZgTRGinZ29UK5FD7G0/fic0Z1brhXdY4jPUVm5YRIp2gIzoO7tH4Nuvitcta+q1tL2O8YECOkp2C/YuXMzB98o4iEw3kkbXhdECe58o86G36lkd38HMBNEMGlfCw1+R/SDGyDER3DIR17g71nff2fht+Ii1rwvldrYZv1rtvQqKrBe9nTwvXtQ1jmFb3RsEtz+Tnx4i9sTqdmdG5Hey/ywjlsbcGNRh435e/wPj2aFZjwURcxDla5iO/kNRfrKgBym0uTJ9Ru/VXCHm+hmZ2iiWfN/eRz83HTsXlW/d1vIexABm705UGrkQ8O4Ly73wa8Uty+XL3W25P+YS0RJSoQiaCNZNjqFD/Qes=
